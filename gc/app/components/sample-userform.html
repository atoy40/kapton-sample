<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../bower_components/iron-form/iron-form.html"><link rel="import" href="../bower_components/paper-input/paper-input.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"></head><body><dom-module id="sample-userform"><template><style is="custom-style" include="iron-flex">:host{display:block;}paper-input{padding:5px;}paper-input#uid[disabled]{--paper-input-container-color:var(--accent-color);--paper-input-container-input-color:var(--accent-color);--paper-input-container-disabled:{opacity:1.0;};}paper-button#createBtn{color:white;background-color:var(--primary-color);}</style><div class=""><h2>Create or update user</h2><iron-form id="userForm"><form class="layout horizontal"><paper-input id="uid" style="width: 220px" label="ID" value="{{editUid}}" disabled="" placeholder="New user"></paper-input><paper-input class="flex" name="lastname" label="Lastname" required="" placeholder="Set lastname" disabled="{{disabled}}"></paper-input><paper-input class="flex" name="firstname" label="Firstname" required="" placeholder="Set firstname" disabled="{{disabled}}"></paper-input><paper-input style="width: 100px" name="age" label="Age" type="number" min="1" max="120" required="" placeholder="Set age" disabled="{{disabled}}"></paper-input></form></iron-form><paper-button id="createBtn" raised="" on-tap="_create" disabled="{{disabled}}">Validate</paper-button><paper-button raised="" on-tap="_reset" disabled="{{disabled}}">Reset</paper-button></div></template><script>var SingleUserMixin=App.createKaptonMixin(App.graphql,App.SINGLE_USER,'options'),AddUserMixin=App.createKaptonMixin(App.graphql,App.ADD_USER,{name:'createUser'}),UpdateUserMixin=App.createKaptonMixin(App.graphql,App.UPDATE_USER,{name:'updateUser'}),SampleUserForm=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'_computeQueryOptions',value:function(d){return void 0===d&&this._reset(),{variables:{id:d},skip:!d}}},{key:'_dataChanged',value:function(d){d.User&&(this.$.userForm.querySelector('paper-input[name=lastname]').value=d.User.lastname,this.$.userForm.querySelector('paper-input[name=firstname]').value=d.User.firstname,this.$.userForm.querySelector('paper-input[name=age]').value=d.User.age)}},{key:'_reset',value:function(){this.editUid=void 0,this.$.userForm.querySelector('paper-input[name=lastname]').value='',this.$.userForm.querySelector('paper-input[name=firstname]').value='',this.$.userForm.querySelector('paper-input[name=age]').value=''}},{key:'_create',value:function(){if(!this.$.userForm.validate())return this.dispatchEvent(new CustomEvent('message',{detail:{msg:'Check input'},composed:!0}));var h,f=this.$.userForm.serializeForm(),g={firstname:f.firstname,lastname:f.lastname,age:parseInt(f.age)};this.disabled=!0,h=this.editUid?this.updateUser({variables:Object.assign({id:this.editUid},g),optimisticResponse:{updateUser:{__typename:'User',id:this.editUid,lastname:g.lastname,firstname:g.firstname,age:g.age}}}).then(function(i){this.dispatchEvent(new CustomEvent('message',{detail:{msg:'User "'+i.data.updateUser.id+'" updated'},composed:!0})),this.editUid=void 0}.bind(this)):this.createUser({variables:g,optimisticResponse:{createUser:{__typename:'User',id:'-------------------------',lastname:g.lastname,firstname:g.firstname,age:g.age}},updateQueries:{usersList:function(j,k){var l=k.mutationResult;return console.log(l),Object.assign({},j,{allUsers:[].concat(babelHelpers.toConsumableArray(j.allUsers),[l.data.createUser])})}}}).then(function(i){this.dispatchEvent(new CustomEvent('message',{detail:{msg:'User added with ID "'+i.data.createUser.id+'"'},composed:!0}))}.bind(this)),h.then(function(){this._reset(),this.disabled=!1}.bind(this)).catch(function(i){console.log(i),this.disabled=!1,this.dispatchEvent(new CustomEvent('message',{detail:{msg:'Unable to add user'},composed:!0}))}.bind(this))}}],[{key:'is',get:function(){return'sample-userform'}},{key:'properties',get:function(){return{editUid:{type:String,notify:!0},disabled:{type:Boolean,value:!1},options:{type:Object,computed:'_computeQueryOptions(editUid)'},data:{type:Object,observer:'_dataChanged'}}}}]),b}(SingleUserMixin(AddUserMixin(UpdateUserMixin(Polymer.Element))));customElements.define(SampleUserForm.is,SampleUserForm);</script></dom-module></body></html>