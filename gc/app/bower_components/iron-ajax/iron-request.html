<html><head><link rel="import" href="../polymer/polymer.html"><script>'use strict';Polymer({is:'iron-request',hostAttributes:{hidden:!0},properties:{xhr:{type:Object,notify:!0,readOnly:!0,value:function(){return new XMLHttpRequest}},response:{type:Object,notify:!0,readOnly:!0,value:function(){return null}},status:{type:Number,notify:!0,readOnly:!0,value:0},statusText:{type:String,notify:!0,readOnly:!0,value:''},completes:{type:Object,readOnly:!0,notify:!0,value:function(){return new Promise(function(b,c){this.resolveCompletes=b,this.rejectCompletes=c}.bind(this))}},progress:{type:Object,notify:!0,readOnly:!0,value:function(){return{}}},aborted:{type:Boolean,notify:!0,readOnly:!0,value:!1},errored:{type:Boolean,notify:!0,readOnly:!0,value:!1},timedOut:{type:Boolean,notify:!0,readOnly:!0,value:!1}},get succeeded(){if(this.errored||this.aborted||this.timedOut)return!1;var a=this.xhr.status||0;return 0===a||200<=a&&300>a},send:function(b){var c=this.xhr;if(0<c.readyState)return null;c.addEventListener('progress',function(l){this._setProgress({lengthComputable:l.lengthComputable,loaded:l.loaded,total:l.total})}.bind(this)),c.addEventListener('error',function(l){this._setErrored(!0),this._updateStatus();var m=b.rejectWithRequest?{error:l,request:this}:l;this.rejectCompletes(m)}.bind(this)),c.addEventListener('timeout',function(l){this._setTimedOut(!0),this._updateStatus();var m=b.rejectWithRequest?{error:l,request:this}:l;this.rejectCompletes(m)}.bind(this)),c.addEventListener('abort',function(){this._setAborted(!0),this._updateStatus();var l=new Error('Request aborted.'),m=b.rejectWithRequest?{error:l,request:this}:l;this.rejectCompletes(m)}.bind(this)),c.addEventListener('loadend',function(){if(this._updateStatus(),this._setResponse(this.parseResponse()),!this.succeeded){var l=new Error('The request failed with status code: '+this.xhr.status),m=b.rejectWithRequest?{error:l,request:this}:l;return void this.rejectCompletes(m)}this.resolveCompletes(this)}.bind(this)),this.url=b.url;var d=!1!==b.async;c.open(b.method||'GET',b.url,d);var f={json:'application/json',text:'text/plain',html:'text/html',xml:'application/xml',arraybuffer:'application/octet-stream'}[b.handleAs],g=b.headers||Object.create(null),h=Object.create(null);for(var i in g)h[i.toLowerCase()]=g[i];if(g=h,f&&!g.accept&&(g.accept=f),Object.keys(g).forEach(function(l){/[A-Z]/.test(l)&&Polymer.Base._error('Headers must be lower case, got',l),c.setRequestHeader(l,g[l])},this),d){c.timeout=b.timeout;var j=b.handleAs;!b.jsonPrefix&&j||(j='text'),c.responseType=c._responseType=j,!b.jsonPrefix||(c._jsonPrefix=b.jsonPrefix)}c.withCredentials=!!b.withCredentials;var k=this._encodeBodyObject(b.body,g['content-type']);return c.send(k),this.completes},parseResponse:function(){var b=this.xhr,c=b.responseType||b._responseType,d=!this.xhr.responseType,f=b._jsonPrefix&&b._jsonPrefix.length||0;try{switch(c){case'json':if(d||b.response===void 0)try{return JSON.parse(b.responseText)}catch(g){return null}return b.response;case'xml':return b.responseXML;case'blob':case'document':case'arraybuffer':return b.response;case'text':default:{if(f)try{return JSON.parse(b.responseText.substring(f))}catch(g){return null}return b.responseText}}}catch(g){this.rejectCompletes(new Error('Could not parse response. '+g.message))}},abort:function(){this._setAborted(!0),this.xhr.abort()},_encodeBodyObject:function(b,c){if('string'==typeof b)return b;var d=b;return'application/json'===c?JSON.stringify(d):'application/x-www-form-urlencoded'===c?this._wwwFormUrlEncode(d):b},_wwwFormUrlEncode:function(b){if(!b)return'';var c=[];return Object.keys(b).forEach(function(d){c.push(this._wwwFormUrlEncodePiece(d)+'='+this._wwwFormUrlEncodePiece(b[d]))},this),c.join('&')},_wwwFormUrlEncodePiece:function(b){return null!==b&&void 0!==b&&b.toString?encodeURIComponent(b.toString().replace(/\r?\n/g,'\r\n')).replace(/%20/g,'+'):''},_updateStatus:function(){this._setStatus(this.xhr.status),this._setStatusText(this.xhr.statusText===void 0?'':this.xhr.statusText)}});</script></head><body></body></html>