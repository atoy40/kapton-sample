<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../bower_components/iron-form/iron-form.html"><link rel="import" href="../bower_components/paper-input/paper-input.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"></head><body><dom-module id="sample-userform"><template><style is="custom-style" include="iron-flex">:host{display:block;}paper-input{padding:5px;}paper-input#uid[disabled]{--paper-input-container-color:var(--accent-color);--paper-input-container-input-color:var(--accent-color);--paper-input-container-disabled:{opacity:1.0;};}paper-button#createBtn{color:white;background-color:var(--primary-color);}</style><div class=""><h2>Create or update user</h2><iron-form id="userForm"><form class="layout horizontal"><paper-input id="uid" style="width: 100px" label="UID" value="{{editUid}}" disabled="" placeholder="New user"></paper-input><paper-input class="flex" name="lastname" label="Lastname" required="" placeholder="Set lastname" disabled="{{disabled}}"></paper-input><paper-input class="flex" name="firstname" label="Firstname" required="" placeholder="Set firstname" disabled="{{disabled}}"></paper-input><paper-input style="width: 100px" name="age" label="Age" type="number" min="1" max="120" required="" placeholder="Set age" disabled="{{disabled}}"></paper-input></form></iron-form><paper-button id="createBtn" raised="" on-tap="_create" disabled="{{disabled}}">Validate</paper-button><paper-button raised="" on-tap="_reset" disabled="{{disabled}}">Reset</paper-button></div></template><script>var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var SingleUserMixin=App.createKaptonMixin(App.graphql,App.SINGLE_USER,"options"),AddUserMixin=App.createKaptonMixin(App.graphql,App.ADD_USER,{name:"createUser"}),UpdateUserMixin=App.createKaptonMixin(App.graphql,App.UPDATE_USER,{name:"updateUser"}),SampleUserForm=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"_computeQueryOptions",value:function(d){return void 0===d&&this._reset(),{variables:{uid:d},skip:!d}}},{key:"_dataChanged",value:function(d){d.user&&(this.$.userForm.querySelector("paper-input[name=lastname]").value=d.user.lastname,this.$.userForm.querySelector("paper-input[name=firstname]").value=d.user.firstname,this.$.userForm.querySelector("paper-input[name=age]").value=d.user.age)}},{key:"_reset",value:function(){this.editUid=void 0,this.$.userForm.querySelector("paper-input[name=lastname]").value="",this.$.userForm.querySelector("paper-input[name=firstname]").value="",this.$.userForm.querySelector("paper-input[name=age]").value=""}},{key:"_create",value:function(){if(!this.$.userForm.validate())return this.dispatchEvent(new CustomEvent("message",{detail:{msg:"Check input"},composed:!0}));var g,f=this.$.userForm.serializeForm();this.disabled=!0,g=this.editUid?this.updateUser({variables:{uid:this.editUid,user:f},optimisticResponse:{updateUser:{__typename:"User",uid:this.editUid,lastname:f.lastname,firstname:f.firstname,age:f.age}}}).then(function(h){this.dispatchEvent(new CustomEvent("message",{detail:{msg:"User \""+h.data.updateUser.uid+"\" updated"},composed:!0})),this.editUid=void 0}.bind(this)):this.createUser({variables:{user:f},optimisticResponse:{addUser:{__typename:"User",uid:"-----",lastname:f.lastname,firstname:f.firstname,age:f.age}},updateQueries:{usersList:function(j,k){var l=k.mutationResult;return Object.assign({},j,{users:[].concat(_toConsumableArray(j.users),[l.data.addUser])})}}}).then(function(h){this.dispatchEvent(new CustomEvent("message",{detail:{msg:"User added with UID \""+h.data.addUser.uid+"\""},composed:!0}))}.bind(this)),g.then(function(){this._reset(),this.disabled=!1}.bind(this)).catch(function(h){console.log(h),this.disabled=!1,this.dispatchEvent(new CustomEVent("message",{detail:{msg:"Unable to add user"},composed:!0}))}.bind(this))}}],[{key:"is",get:function(){return"sample-userform"}},{key:"properties",get:function(){return{editUid:{type:String,notify:!0},disabled:{type:Boolean,value:!1},options:{type:Object,computed:"_computeQueryOptions(editUid)"},data:{type:Object,observer:"_dataChanged"}}}}]),b}(SingleUserMixin(AddUserMixin(UpdateUserMixin(Polymer.Element))));customElements.define(SampleUserForm.is,SampleUserForm);</script></dom-module></body></html>