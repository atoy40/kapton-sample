<html><head><link rel="import" href="boot.html"><link rel="import" href="async.html"><link rel="import" href="debounce.html"><script>(function(){'use strict';function a(F){for(var I,G=B?['click']:v,H=0;H<G.length;H++)I=G[H],F?document.addEventListener(I,C,!0):document.removeEventListener(I,C,!0)}function c(F){var G=F.type;if(-1===v.indexOf(G))return!1;if('mousemove'===G){var H=void 0===F.buttons?1:F.buttons;return F instanceof window.MouseEvent&&!z&&(H=w[F.which]||0),!!(1&H)}var I=void 0===F.button?0:F.button;return 0===I}function d(F){if('click'===F.type){if(0===F.detail)return!0;var G=E._findOriginalTarget(F);if(G.nodeType!==Node.ELEMENT_NODE)return!0;var H=G.getBoundingClientRect(),I=F.pageX,J=F.pageY;return!(I>=H.left&&I<=H.right&&J>=H.top&&J<=H.bottom)}return!1}function f(F){var G='auto',H=F.composedPath&&F.composedPath();if(H)for(var J,I=0;I<H.length;I++)if(J=H[I],J[o]){G=J[o];break}return G}function g(F,G,H){F.movefn=G,F.upfn=H,document.addEventListener('mousemove',G),document.addEventListener('mouseup',H)}function h(F){document.removeEventListener('mousemove',F.movefn),document.removeEventListener('mouseup',F.upfn),F.movefn=null,F.upfn=null}var k='string'==typeof document.head.style.touchAction,l='__polymerGestures',m='__polymerGesturesHandled',o='__polymerGesturesTouchAction',p=25,q=5,v=['mousedown','mousemove','mouseup','click'],w=[0,1,4,2],z=function(){try{return 1===new MouseEvent('test',{buttons:1}).buttons}catch(F){return!1}}(),A=!1;(function(){try{var F=Object.defineProperty({},'passive',{get:function(){A=!0}});window.addEventListener('test',null,F),window.removeEventListener('test',null,F)}catch(G){}})();var B=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/),C=function(G){var H=G.sourceCapabilities;if((!H||H.firesTouchEvents)&&(G[m]={skip:!0},'click'===G.type)){var I=G.composedPath&&G.composedPath();if(I)for(var J=0;J<I.length;J++)if(I[J]===D.mouse.target)return;G.preventDefault(),G.stopPropagation()}},D={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};document.addEventListener('touchend',function(F){D.mouse.mouseIgnoreJob||a(!0);D.mouse.target=F.composedPath()[0],D.mouse.mouseIgnoreJob=Polymer.Debouncer.debounce(D.mouse.mouseIgnoreJob,Polymer.Async.timeOut.after(2500),function(){a(),D.mouse.target=null,D.mouse.mouseIgnoreJob=null})},!!A&&{passive:!0});var E={gestures:{},recognizers:[],deepTargetFind:function(G,H){for(var K,I=document.elementFromPoint(G,H),J=I;J&&J.shadowRoot&&!window.ShadyDOM&&(K=J,J=J.shadowRoot.elementFromPoint(G,H),K!==J);)J&&(I=J);return I},_findOriginalTarget:function(G){return G.composedPath?G.composedPath()[0]:G.target},_handleNative:function(G){var H,I=G.type,J=G.currentTarget,K=J[l];if(K){var L=K[I];if(L){if(!G[m]&&(G[m]={},'touch'===I.slice(0,5))){var M=G.changedTouches[0];if('touchstart'===I&&1===G.touches.length&&(D.touch.id=M.identifier),D.touch.id!==M.identifier)return;k||'touchstart'!==I&&'touchmove'!==I||E._handleTouchAction(G)}if(H=G[m],!H.skip){for(var P,N=E.recognizers,O=0;O<N.length;O++)P=N[O],L[P.name]&&!H[P.name]&&P.flow&&-1<P.flow.start.indexOf(G.type)&&P.reset&&P.reset();for(var R,Q=0;Q<N.length;Q++)R=N[Q],L[R.name]&&!H[R.name]&&(H[R.name]=!0,R[I](G))}}}},_handleTouchAction:function(G){var H=G.changedTouches[0],I=G.type;if('touchstart'===I)D.touch.x=H.clientX,D.touch.y=H.clientY,D.touch.scrollDecided=!1;else if('touchmove'===I){if(D.touch.scrollDecided)return;D.touch.scrollDecided=!0;var J=f(G),K=!1,L=Math.abs(D.touch.x-H.clientX),M=Math.abs(D.touch.y-H.clientY);G.cancelable&&('none'===J?K=!0:'pan-x'===J?K=M>L:'pan-y'===J&&(K=L>M)),K?G.preventDefault():E.prevent('track')}},addListener:function(G,H,I){if(this.gestures[H])return this._add(G,H,I),!0},removeListener:function(G,H,I){if(this.gestures[H])return this._remove(G,H,I),!0},_add:function(G,H,I){var J=this.gestures[H],K=J.deps,L=J.name,M=G[l];M||(G[l]=M={});for(var O,P,N=0;N<K.length;N++)(O=K[N],!(B&&-1<v.indexOf(O)&&'click'!==O))&&(P=M[O],P||(M[O]=P={_count:0}),0===P._count&&G.addEventListener(O,this._handleNative),P[L]=(P[L]||0)+1,P._count=(P._count||0)+1);G.addEventListener(H,I),J.touchAction&&this.setTouchAction(G,J.touchAction)},_remove:function(G,H,I){var J=this.gestures[H],K=J.deps,L=J.name,M=G[l];if(M)for(var O,P,N=0;N<K.length;N++)O=K[N],P=M[O],P&&P[L]&&(P[L]=(P[L]||1)-1,P._count=(P._count||1)-1,0===P._count&&G.removeEventListener(O,this._handleNative));G.removeEventListener(H,I)},register:function(G){this.recognizers.push(G);for(var H=0;H<G.emits.length;H++)this.gestures[G.emits[H]]=G},_findRecognizerByEvent:function(G){for(var I,H=0;H<this.recognizers.length;H++){I=this.recognizers[H];for(var K,J=0;J<I.emits.length;J++)if(K=I.emits[J],K===G)return I}return null},setTouchAction:function(G,H){k&&(G.style.touchAction=H),G[o]=H},_fire:function(G,H,I){var J=new Event(H,{bubbles:!0,cancelable:!0,composed:!0});if(J.detail=I,G.dispatchEvent(J),J.defaultPrevented){var K=I.preventer||I.sourceEvent;K&&K.preventDefault&&K.preventDefault()}},prevent:function(G){var H=this._findRecognizerByEvent(G);H.info&&(H.info.prevent=!0)},resetMouseCanceller:function(){D.mouse.mouseIgnoreJob&&D.mouse.mouseIgnoreJob.flush()}};E.register({name:'downup',deps:['mousedown','touchstart','touchend'],flow:{start:['mousedown','touchstart'],end:['mouseup','touchend']},emits:['down','up'],info:{movefn:null,upfn:null},reset:function(){h(this.info)},mousedown:function(G){if(c(G)){var H=E._findOriginalTarget(G),I=this,J=function(M){c(M)||(I._fire('up',H,M),h(I.info))},K=function(M){c(M)&&I._fire('up',H,M),h(I.info)};g(this.info,J,K),this._fire('down',H,G)}},touchstart:function(G){this._fire('down',E._findOriginalTarget(G),G.changedTouches[0],G)},touchend:function(G){this._fire('up',E._findOriginalTarget(G),G.changedTouches[0],G)},_fire:function(G,H,I,J){E._fire(H,G,{x:I.clientX,y:I.clientY,sourceEvent:I,preventer:J,prevent:function(L){return E.prevent(L)}})}}),E.register({name:'track',touchAction:'none',deps:['mousedown','touchstart','touchmove','touchend'],flow:{start:['mousedown','touchstart'],end:['mouseup','touchend']},emits:['track'],info:{x:0,y:0,state:'start',started:!1,moves:[],addMove:function(G){this.moves.length>2&&this.moves.shift(),this.moves.push(G)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state='start',this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,h(this.info)},hasMovedEnough:function(G,H){if(this.info.prevent)return!1;if(this.info.started)return!0;var I=Math.abs(this.info.x-G),J=Math.abs(this.info.y-H);return I>=q||J>=q},mousedown:function(G){if(c(G)){var H=E._findOriginalTarget(G),I=this,J=function(M){var N=M.clientX,O=M.clientY;I.hasMovedEnough(N,O)&&(I.info.state=I.info.started?'mouseup'===M.type?'end':'track':'start','start'===I.info.state&&E.prevent('tap'),I.info.addMove({x:N,y:O}),!c(M)&&(I.info.state='end',h(I.info)),I._fire(H,M),I.info.started=!0)},K=function(M){I.info.started&&J(M),h(I.info)};g(this.info,J,K),this.info.x=G.clientX,this.info.y=G.clientY}},touchstart:function(G){var H=G.changedTouches[0];this.info.x=H.clientX,this.info.y=H.clientY},touchmove:function(G){var H=E._findOriginalTarget(G),I=G.changedTouches[0],J=I.clientX,K=I.clientY;this.hasMovedEnough(J,K)&&('start'===this.info.state&&E.prevent('tap'),this.info.addMove({x:J,y:K}),this._fire(H,I),this.info.state='track',this.info.started=!0)},touchend:function(G){var H=E._findOriginalTarget(G),I=G.changedTouches[0];this.info.started&&(this.info.state='end',this.info.addMove({x:I.clientX,y:I.clientY}),this._fire(H,I,G))},_fire:function(G,H){var M,I=this.info.moves[this.info.moves.length-2],J=this.info.moves[this.info.moves.length-1],K=J.x-this.info.x,L=J.y-this.info.y,N=0;return I&&(M=J.x-I.x,N=J.y-I.y),E._fire(G,'track',{state:this.info.state,x:H.clientX,y:H.clientY,dx:K,dy:L,ddx:M,ddy:N,sourceEvent:H,hover:function(){return E.deepTargetFind(H.clientX,H.clientY)}})}}),E.register({name:'tap',deps:['mousedown','click','touchstart','touchend'],flow:{start:['mousedown','touchstart'],end:['click','touchend']},emits:['tap'],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},save:function(G){this.info.x=G.clientX,this.info.y=G.clientY},mousedown:function(G){c(G)&&this.save(G)},click:function(G){c(G)&&this.forward(G)},touchstart:function(G){this.save(G.changedTouches[0],G)},touchend:function(G){this.forward(G.changedTouches[0],G)},forward:function(G,H){var I=Math.abs(G.clientX-this.info.x),J=Math.abs(G.clientY-this.info.y),K=E._findOriginalTarget(G);(isNaN(I)||isNaN(J)||I<=p&&J<=p||d(G))&&!this.info.prevent&&E._fire(K,'tap',{x:G.clientX,y:G.clientY,sourceEvent:G,preventer:H})}}),E.findOriginalTarget=E._findOriginalTarget,E.add=E.addListener,E.remove=E.removeListener,Polymer.Gestures=E})();</script></head><body></body></html>